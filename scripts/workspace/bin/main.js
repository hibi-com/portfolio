#!/usr/bin/env bun
// @bun
var be=Object.create;var{getPrototypeOf:xe,defineProperty:I,getOwnPropertyNames:we}=Object;var ke=Object.prototype.hasOwnProperty;var T=(t,e,o)=>{o=t!=null?be(xe(t)):{};let n=e||!t||!t.__esModule?I(o,"default",{value:t,enumerable:!0}):o;for(let s of we(t))if(!ke.call(n,s))I(n,s,{get:()=>t[s],enumerable:!0});return n};var ye=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Y=(t,e)=>{for(var o in e)I(t,o,{get:e[o],enumerable:!0,configurable:!0,set:(n)=>e[o]=()=>n})};var k=(t,e)=>()=>(t&&(e=t(t=0)),e);var D=ye((ut,_)=>{var O=process||{},te=O.argv||[],S=O.env||{},Te=!(!!S.NO_COLOR||te.includes("--no-color"))&&(!!S.FORCE_COLOR||te.includes("--color")||O.platform==="win32"||(O.stdout||{}).isTTY&&S.TERM!=="dumb"||!!S.CI),Ne=(t,e,o=t)=>(n)=>{let s=""+n,i=s.indexOf(e,t.length);return~i?t+Re(s,e,o,i)+e:t+s+e},Re=(t,e,o,n)=>{let s="",i=0;do s+=t.substring(i,n)+o,i=n+e.length,n=t.indexOf(e,i);while(~n);return s+t.substring(i)},oe=(t=Te)=>{let e=t?Ne:()=>String;return{isColorSupported:t,reset:e("\x1B[0m","\x1B[0m"),bold:e("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"),dim:e("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"),italic:e("\x1B[3m","\x1B[23m"),underline:e("\x1B[4m","\x1B[24m"),inverse:e("\x1B[7m","\x1B[27m"),hidden:e("\x1B[8m","\x1B[28m"),strikethrough:e("\x1B[9m","\x1B[29m"),black:e("\x1B[30m","\x1B[39m"),red:e("\x1B[31m","\x1B[39m"),green:e("\x1B[32m","\x1B[39m"),yellow:e("\x1B[33m","\x1B[39m"),blue:e("\x1B[34m","\x1B[39m"),magenta:e("\x1B[35m","\x1B[39m"),cyan:e("\x1B[36m","\x1B[39m"),white:e("\x1B[37m","\x1B[39m"),gray:e("\x1B[90m","\x1B[39m"),bgBlack:e("\x1B[40m","\x1B[49m"),bgRed:e("\x1B[41m","\x1B[49m"),bgGreen:e("\x1B[42m","\x1B[49m"),bgYellow:e("\x1B[43m","\x1B[49m"),bgBlue:e("\x1B[44m","\x1B[49m"),bgMagenta:e("\x1B[45m","\x1B[49m"),bgCyan:e("\x1B[46m","\x1B[49m"),bgWhite:e("\x1B[47m","\x1B[49m"),blackBright:e("\x1B[90m","\x1B[39m"),redBright:e("\x1B[91m","\x1B[39m"),greenBright:e("\x1B[92m","\x1B[39m"),yellowBright:e("\x1B[93m","\x1B[39m"),blueBright:e("\x1B[94m","\x1B[39m"),magentaBright:e("\x1B[95m","\x1B[39m"),cyanBright:e("\x1B[96m","\x1B[39m"),whiteBright:e("\x1B[97m","\x1B[39m"),bgBlackBright:e("\x1B[100m","\x1B[49m"),bgRedBright:e("\x1B[101m","\x1B[49m"),bgGreenBright:e("\x1B[102m","\x1B[49m"),bgYellowBright:e("\x1B[103m","\x1B[49m"),bgBlueBright:e("\x1B[104m","\x1B[49m"),bgMagentaBright:e("\x1B[105m","\x1B[49m"),bgCyanBright:e("\x1B[106m","\x1B[49m"),bgWhiteBright:e("\x1B[107m","\x1B[49m")}};_.exports=oe();_.exports.createColors=oe});var ne={};Y(ne,{logSubStep:()=>x,logStep:()=>u,logSection:()=>w,LoadingBar:()=>b});function w(t){console.log(),console.log(p.default.bold(p.default.cyan(`  ${t}`))),console.log(p.default.dim(`  ${"\u2500".repeat(50)}`))}function u(t,e,o="info"){let n={info:p.default.blue,success:p.default.green,warning:p.default.yellow,error:p.default.red},s;if(o==="success")s="\u2713";else if(o==="error")s="\u2717";else if(o==="warning")s="\u26A0";else s="\u2192";console.log(`  ${n[o](s)} ${t} ${e}`)}function x(t,e="info"){let o={info:p.default.dim,success:p.default.green,warning:p.default.yellow},n;if(e==="success")n="\u2713";else if(e==="warning")n="\u26A0";else n="  ";console.log(`    ${o[e](n)} ${t}`)}class b{message;interval=null;frames=["\u280B","\u2819","\u2839","\u2838","\u283C","\u2834","\u2826","\u2827","\u2807","\u280F"];frameIndex=0;isActive=!1;constructor(t){this.message=t}start(){if(this.isActive)return;this.isActive=!0,this.frameIndex=0,this.interval=setInterval(()=>{let t=this.frames[this.frameIndex%this.frames.length];process.stdout.write(`\r    ${p.default.cyan(t)} ${p.default.dim(this.message)}`),this.frameIndex++},100)}stop(t=!0,e){if(!this.isActive)return;if(this.isActive=!1,this.interval)clearInterval(this.interval),this.interval=null;if(process.stdout.write(`\r${" ".repeat(80)}\r`),e)x(e,t?"success":"warning")}}var p;var y=k(()=>{p=T(D(),1)});import{existsSync as se}from"fs";import{createInterface as Le}from"readline";var{$:B}=globalThis.Bun;async function ae(t){let e=process.env.PATH||"",o=t,n="",s=!0;if(t==="pulumi"){let i=process.env.HOME||process.env.USERPROFILE||"~",l=`${i}/.pulumi/bin`,c=`${l}/pulumi`;if(se(c)){if(!e.includes(l))s=!1;o=c}else if(se(l))n=`${l}:`,process.env.PATH=`${n}${e}`;else return{installed:!1,inPath:!1};process.env.PULUMI_HOME=`${i}/.pulumi`}try{return await B`${o} ${t==="pulumi"?"version":"--version"}`.quiet(),{installed:!0,inPath:s}}catch{return{installed:!1,inPath:!1}}}async function _e(t){let e=Le({input:process.stdin,output:process.stdout});return new Promise((o)=>{e.question(t,(n)=>{e.close();let s=n.trim().toLowerCase();o(s==="y"||s==="yes"||s==="\u306F\u3044")})})}async function qe(){u("","nvm\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u3044\u307E\u3059...","info");try{await B`curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash`.quiet(),u("","nvm\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F","success"),u("","\u30B7\u30A7\u30EB\u3092\u518D\u8D77\u52D5\u3059\u308B\u304B\u3001\u4EE5\u4E0B\u306E\u30B3\u30DE\u30F3\u30C9\u3092\u5B9F\u884C\u3057\u3066\u304F\u3060\u3055\u3044:","info"),console.log(f.default.dim(String.raw`    export NVM_DIR="$HOME/.nvm"`)),console.log(f.default.dim(String.raw`    [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"`)),console.log(f.default.dim(String.raw`    nvm install --lts`)),console.log(),console.log(f.default.yellow("  \u6CE8\u610F: node\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u306F\u30B7\u30A7\u30EB\u306E\u518D\u8D77\u52D5\u304C\u5FC5\u8981\u3067\u3059\u3002"))}catch(t){throw u("","nvm\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F","error"),t}}async function Me(){if(process.platform==="darwin")throw u("","macOS\u3067\u306FDocker Desktop\u304C\u5FC5\u8981\u3067\u3059\u3002get.docker.com\u30B9\u30AF\u30EA\u30D7\u30C8\u306F\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093","warning"),u("","Docker Desktop\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u304F\u3060\u3055\u3044: https://www.docker.com/products/docker-desktop","info"),new Error("macOS\u3067\u306FDocker Desktop\u304C\u5FC5\u8981\u3067\u3059\u3002get.docker.com\u30B9\u30AF\u30EA\u30D7\u30C8\u306F\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093");let t=new b("Docker\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u3044\u307E\u3059...");t.start();try{if((await B`curl -fsSL https://get.docker.com/ | sh`.quiet()).exitCode!==0)throw t.stop(!1),new Error("Docker\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F");t.stop(!0,"Docker\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(e){throw t.stop(!1),u("","Docker\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F","error"),e}}async function Ue(t,e){let o=new b(`${t}\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u3044\u307E\u3059...`);o.start();try{let n=await B`bash -c ${e}`.quiet();if(n.exitCode!==0){let s=n.stderr.toString()||n.stdout.toString();if(o.stop(!1),u("",`${t}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F`,"error"),s)console.error(f.default.dim(`  \u30A8\u30E9\u30FC\u51FA\u529B: ${s.trim()}`));throw new Error(`\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u30B9\u30AF\u30EA\u30D7\u30C8\u304C\u7D42\u4E86\u30B3\u30FC\u30C9 ${n.exitCode} \u3067\u7D42\u4E86\u3057\u307E\u3057\u305F`)}o.stop(!0,`${t}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F`)}catch(n){if(o.stop(!1),u("",`${t}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F`,"error"),n instanceof Error)console.error(f.default.dim(`  \u30A8\u30E9\u30FC: ${n.message}`));if(process.env.DEBUG)console.error(n);throw n}}async function He(t){if(typeof t.installScript==="string")await Ue(t.name,t.installScript);else await t.installScript()}function je(t){if(t!=="pulumi")return;let e=process.env.HOME||process.env.USERPROFILE||"~";if(u("","PATH\u306B\u8FFD\u52A0\u3059\u308B\u306B\u306F\u3001\u30B7\u30A7\u30EB\u8A2D\u5B9A\u30D5\u30A1\u30A4\u30EB\u306B\u4EE5\u4E0B\u3092\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044:","info"),(process.env.SHELL||"").includes("fish"))console.log(f.default.dim(String.raw`    fish_add_path ${e}/.pulumi/bin`));else console.log(f.default.dim(String.raw`    export PATH="$HOME/.pulumi/bin:$PATH"`))}function le(t,e,o){let n=o?`${t.name}\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u3059`:`${t.name}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u78BA\u8A8D\u3055\u308C\u307E\u3057\u305F`;if(e)u("",n,"success");else{let s=o?`${t.name}\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u3059\u304C\u3001PATH\u306B\u542B\u307E\u308C\u3066\u3044\u307E\u305B\u3093`:`${t.name}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u78BA\u8A8D\u3055\u308C\u307E\u3057\u305F\u304C\u3001PATH\u306B\u542B\u307E\u308C\u3066\u3044\u307E\u305B\u3093`;u("",s,"warning"),je(t.name)}}async function Ve(t,e){let o=e?"\uFF08\u30AA\u30D7\u30B7\u30E7\u30F3\uFF09":"",n=`${t.name}\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u305B\u3093${o}\u3002\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u307E\u3059\u304B\uFF1F (y/n): `;if(!await _e(n)){let i=e?"info":"warning";return u("",`${t.name}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3092\u30B9\u30AD\u30C3\u30D7\u3057\u307E\u3057\u305F`,i),!1}return!0}async function Fe(t){try{await He(t);let{installed:e,inPath:o}=await ae(t.checkCommand);if(e)le(t,o,!1);else u("",`${t.name}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u5F8C\u3001\u30B3\u30DE\u30F3\u30C9\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002\u30B7\u30A7\u30EB\u3092\u518D\u8D77\u52D5\u3057\u3066\u304F\u3060\u3055\u3044`,"warning")}catch(e){if(u("",`${t.name}\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F`,"error"),e instanceof Error)console.error(f.default.dim(`  \u30A8\u30E9\u30FC: ${e.message}`));if(process.env.DEBUG)console.error(e)}}async function Ge(t,e){let{installed:o,inPath:n}=await ae(t.checkCommand);if(o){le(t,n,!0);return}if(!await Ve(t,e))return;await Fe(t)}async function re(t,e){if(e&&t.length>0)console.log(),u("","\u30AA\u30D7\u30B7\u30E7\u30F3\u30B3\u30DE\u30F3\u30C9\u306E\u78BA\u8A8D","info");for(let o of t){if(!o)continue;await Ge(o,e)}}async function P(){w("\uD83D\uDD0D \u30B3\u30DE\u30F3\u30C9\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u78BA\u8A8D");let t=ie.filter((o)=>o.required),e=ie.filter((o)=>!o.required);await re(t,!1),await re(e,!0),console.log(),u("","\u30B3\u30DE\u30F3\u30C9\u306E\u78BA\u8A8D\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F","success")}var f,ie;var q=k(()=>{f=T(D(),1);y();ie=[{name:"node",checkCommand:"node",installScript:qe,description:"Node.js (nvm\u7D4C\u7531)",required:!0},{name:"bun",checkCommand:"bun",installScript:"curl -fsSL https://bun.sh/install | bash",description:"Bun",required:!0},{name:"docker",checkCommand:"docker",installScript:Me,description:"Docker",required:!0},{name:"pulumi",checkCommand:"pulumi",installScript:"curl -fsSL https://get.pulumi.com | sh",description:"Pulumi",required:!0},{name:"claude",checkCommand:"claude",installScript:"curl -fsSL https://claude.ai/install.sh | bash",description:"Claude Code",required:!1}]});import{existsSync as ce}from"fs";import{join as me,resolve as M}from"path";function E(t=process.cwd()){let e=M(t),o=M("/");while(e!==o){let n=me(e,"package.json"),s=me(e,"turbo.json");if(ce(n)&&ce(s))return e;e=M(e,"..")}return process.cwd()}var U=()=>{};import{existsSync as We}from"fs";import{join as Ye}from"path";var{$:H}=globalThis.Bun;async function Ke(t){try{return(await H`docker images --format {{.Repository}}:{{.Tag}}`.quiet()).stdout.toString().trim().split(`
`).some((n)=>n.startsWith(`${t}:`)||n===t)}catch{return!1}}async function Je(t,e,o){let n=new b(`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059`);n.start();try{await H`docker build -t ${e.imageName} -f ${o} .`.cwd(t).quiet(),n.stop(!0,`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F`)}catch(s){throw n.stop(!1,`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F`),s}}async function Qe(t,e,o){x(`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059...`,"info");try{await H`docker build -t ${e.imageName} -f ${o} .`.cwd(t).quiet(),x(`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F`,"success")}catch(n){throw x(`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F`,"warning"),n}}async function Xe(t,e,o){let n=Ye(t,e.dockerfilePath);if(!We(n))return;if(await Ke(e.imageName)){x(`${e.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u306F\u65E2\u306B\u5B58\u5728\u3057\u307E\u3059`,"success");return}if(o)await Je(t,e,n);else await Qe(t,e,n)}async function ue(t){let{rootDir:e,useLoadingBar:o,dockerTargets:n}=t,s=n??[...ze];w("\uD83D\uDC33 Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9");for(let i of s)try{await Xe(e,i,o)}catch(l){if(x(`${i.displayName}Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F`,"warning"),process.env.DEBUG)console.error(l)}}var ze;var de=k(()=>{y();ze=[{imageName:"e2e",dockerfilePath:".docker/e2e/Dockerfile",displayName:"E2E\u7528"}]});var{$:Ze}=globalThis.Bun;async function he(t){w("\uD83D\uDCE6 \u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB");let e=new b("\u4F9D\u5B58\u95A2\u4FC2\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u3044\u307E\u3059");e.start();try{await Ze`bun install --ignore-scripts`.cwd(t.rootDir).quiet(),e.stop(!0,"\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(o){if(e.stop(!1,"\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),process.env.DEBUG)console.error(o);throw o}}var pe=k(()=>{y()});var ge={};Y(ge,{runWorkspace:()=>V,findRootDir:()=>E,SETUP_STEPS:()=>j});var{$:fe}=globalThis.Bun;function et(t){return!t.install&&!t.docker}function tt(t){let e=et(t);return{runInstall:e||t.install!==!1,runDocker:e||t.docker!==!1,parallel:t.parallel??!0}}function ot(){console.log(),console.log(m.default.bold(m.default.cyan("  \u256D\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256E"))),console.log(m.default.bold(m.default.cyan("  \u2502  \uD83D\uDE80 \u958B\u767A\u74B0\u5883\u306E\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3092\u958B\u59CB\u3057\u307E\u3059      \u2502"))),console.log(m.default.bold(m.default.cyan("  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256F")))}function nt(){console.log(),console.log(m.default.bold(m.default.green("  \u256D\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256E"))),console.log(m.default.bold(m.default.green("  \u2502  \u2705 \u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F\uFF01            \u2502"))),console.log(m.default.bold(m.default.green("  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256F"))),console.log(),console.log(m.default.bold("  \u6B21\u306E\u30B9\u30C6\u30C3\u30D7:")),console.log(m.default.dim("    \u2022 bun run dev \u3067\u958B\u767A\u30B5\u30FC\u30D0\u30FC\uFF08docker compose up\uFF09\u3092\u8D77\u52D5\u3067\u304D\u307E\u3059")),console.log()}function st(t){console.log(),console.error(m.default.bold(m.default.red("  \u256D\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256E"))),console.error(m.default.bold(m.default.red("  \u2502  \u2717 \u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F    \u2502"))),console.error(m.default.bold(m.default.red("  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256F"))),console.error(),console.error(m.default.red("  "),t),console.error()}async function it(){if(process.versions?.bun!==void 0)return!0;try{if(fe!==void 0)return await fe`bun --version`.quiet(),!0}catch{return!1}return!1}async function rt(t,e){if(!e)return;if(process.env.BUN_LIFECYCLE_EVENT==="prepare"){let{logSection:n}=await Promise.resolve().then(() => (y(),ne));n("\uD83D\uDCE6 \u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB"),u("","\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3092\u30B9\u30AD\u30C3\u30D7\u3057\u307E\u3057\u305F\uFF08prepare\u30B9\u30AF\u30EA\u30D7\u30C8\u304B\u3089\u5B9F\u884C\u4E2D\uFF09","info");return}await j.install({rootDir:t,useLoadingBar:!0})}async function at(t,e,o){let n=!o;if(e)await j.docker({rootDir:t,useLoadingBar:n})}async function V(t={}){let e=E(),o=tt(t);if(ot(),!await it())console.log(),console.error(m.default.red("  \u2717 Bun\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002")),console.error(m.default.dim("    Bun\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u304F\u3060\u3055\u3044: https://bun.sh")),process.exit(1);u("","Bun\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u3059","success");try{await P(),await rt(e,o.runInstall),await at(e,o.runDocker,o.parallel),nt()}catch(s){st(s),process.exit(1)}}var m,j;var F=k(()=>{m=T(D(),1);q();y();U();de();pe();U();j={install:he,docker:ue}});import{EventEmitter as ve}from"events";function N(t){return t==null?[]:Array.isArray(t)?t:[t]}function Ce(t,e,o,n){var s,i=t[e],l=~n.string.indexOf(e)?o==null||o===!0?"":String(o):typeof o==="boolean"?o:~n.boolean.indexOf(e)?o==="false"?!1:o==="true"||(t._.push((s=+o,s*0===0)?s:o),!!o):(s=+o,s*0===0)?s:o;t[e]=i==null?l:Array.isArray(i)?i.concat(l):[i,l]}function $e(t,e){t=t||[],e=e||{};var o,n,s,i,l,c={_:[]},r=0,a=0,h=0,d=t.length;let g=e.alias!==void 0,A=e.unknown!==void 0,G=e.default!==void 0;if(e.alias=e.alias||{},e.string=N(e.string),e.boolean=N(e.boolean),g)for(o in e.alias){n=e.alias[o]=N(e.alias[o]);for(r=0;r<n.length;r++)(e.alias[n[r]]=n.concat(o)).splice(r,1)}for(r=e.boolean.length;r-- >0;){n=e.alias[e.boolean[r]]||[];for(a=n.length;a-- >0;)e.boolean.push(n[a])}for(r=e.string.length;r-- >0;){n=e.alias[e.string[r]]||[];for(a=n.length;a-- >0;)e.string.push(n[a])}if(G){for(o in e.default)if(i=typeof e.default[o],n=e.alias[o]=e.alias[o]||[],e[i]!==void 0){e[i].push(o);for(r=0;r<n.length;r++)e[i].push(n[r])}}let W=A?Object.keys(e.alias):[];for(r=0;r<d;r++){if(s=t[r],s==="--"){c._=c._.concat(t.slice(++r));break}for(a=0;a<s.length;a++)if(s.charCodeAt(a)!==45)break;if(a===0)c._.push(s);else if(s.substring(a,a+3)==="no-"){if(i=s.substring(a+3),A&&!~W.indexOf(i))return e.unknown(s);c[i]=!1}else{for(h=a+1;h<s.length;h++)if(s.charCodeAt(h)===61)break;i=s.substring(a,h),l=s.substring(++h)||(r+1===d||(""+t[r+1]).charCodeAt(0)===45||t[++r]),n=a===2?[i]:i;for(h=0;h<n.length;h++){if(i=n[h],A&&!~W.indexOf(i))return e.unknown("-".repeat(a)+i);Ce(c,i,h+1<n.length||l,e)}}}if(G){for(o in e.default)if(c[o]===void 0)c[o]=e.default[o]}if(g)for(o in c){n=e.alias[o]||[];while(n.length>0)c[n.shift()]=c[o]}return c}var J=(t)=>t.replace(/[<[].+/,"").trim(),Se=(t)=>{let e=/<([^>]+)>/g,o=/\[([^\]]+)\]/g,n=[],s=(c)=>{let r=!1,a=c[1];if(a.startsWith("..."))a=a.slice(3),r=!0;return{required:c[0].startsWith("<"),value:a,variadic:r}},i;while(i=e.exec(t))n.push(s(i));let l;while(l=o.exec(t))n.push(s(l));return n},Oe=(t)=>{let e={alias:{},boolean:[]};for(let[o,n]of t.entries()){if(n.names.length>1)e.alias[n.names[0]]=n.names.slice(1);if(n.isBoolean)if(n.negated){if(!t.some((i,l)=>{return l!==o&&i.names.some((c)=>n.names.includes(c))&&typeof i.required==="boolean"}))e.boolean.push(n.names[0])}else e.boolean.push(n.names[0])}return e},z=(t)=>{return t.sort((e,o)=>{return e.length>o.length?-1:1})[0]},K=(t,e)=>{return t.length>=e?t:`${t}${" ".repeat(e-t.length)}`},De=(t)=>{return t.replace(/([a-z])-([a-z])/g,(e,o,n)=>{return o+n.toUpperCase()})},Be=(t,e,o)=>{let n=0,s=e.length,i=t,l;for(;n<s;++n)l=i[e[n]],i=i[e[n]]=n===s-1?o:l!=null?l:!!~e[n+1].indexOf(".")||!(+e[n+1]>-1)?{}:[]},Pe=(t,e)=>{for(let o of Object.keys(e)){let n=e[o];if(n.shouldTransform){if(t[o]=Array.prototype.concat.call([],t[o]),typeof n.transformFunction==="function")t[o]=t[o].map(n.transformFunction)}}},Ee=(t)=>{let e=/([^\\\/]+)$/.exec(t);return e?e[1]:""},Q=(t)=>{return t.split(".").map((e,o)=>{return o===0?De(e):e}).join(".")};class $ extends Error{constructor(t){super(t);if(this.name=this.constructor.name,typeof Error.captureStackTrace==="function")Error.captureStackTrace(this,this.constructor);else this.stack=new Error(t).stack}}class X{constructor(t,e,o){if(this.rawName=t,this.description=e,this.config=Object.assign({},o),t=t.replace(/\.\*/g,""),this.negated=!1,this.names=J(t).split(",").map((n)=>{let s=n.trim().replace(/^-{1,2}/,"");if(s.startsWith("no-"))this.negated=!0,s=s.replace(/^no-/,"");return Q(s)}).sort((n,s)=>n.length>s.length?1:-1),this.name=this.names[this.names.length-1],this.negated&&this.config.default==null)this.config.default=!0;if(t.includes("<"))this.required=!0;else if(t.includes("["))this.required=!1;else this.isBoolean=!0}}var Ae=process.argv,Ie=`${process.platform}-${process.arch} node-${process.version}`;class R{constructor(t,e,o={},n){this.rawName=t,this.description=e,this.config=o,this.cli=n,this.options=[],this.aliasNames=[],this.name=J(t),this.args=Se(t),this.examples=[]}usage(t){return this.usageText=t,this}allowUnknownOptions(){return this.config.allowUnknownOptions=!0,this}ignoreOptionDefaultValue(){return this.config.ignoreOptionDefaultValue=!0,this}version(t,e="-v, --version"){return this.versionNumber=t,this.option(e,"Display version number"),this}example(t){return this.examples.push(t),this}option(t,e,o){let n=new X(t,e,o);return this.options.push(n),this}alias(t){return this.aliasNames.push(t),this}action(t){return this.commandAction=t,this}isMatched(t){return this.name===t||this.aliasNames.includes(t)}get isDefaultCommand(){return this.name===""||this.aliasNames.includes("!")}get isGlobalCommand(){return this instanceof L}hasOption(t){return t=t.split(".")[0],this.options.find((e)=>{return e.names.includes(t)})}outputHelp(){let{name:t,commands:e}=this.cli,{versionNumber:o,options:n,helpCallback:s}=this.cli.globalCommand,i=[{body:`${t}${o?`/${o}`:""}`}];if(i.push({title:"Usage",body:`  $ ${t} ${this.usageText||this.rawName}`}),(this.isGlobalCommand||this.isDefaultCommand)&&e.length>0){let r=z(e.map((a)=>a.rawName));i.push({title:"Commands",body:e.map((a)=>{return`  ${K(a.rawName,r.length)}  ${a.description}`}).join(`
`)}),i.push({title:"For more info, run any command with the `--help` flag",body:e.map((a)=>`  $ ${t}${a.name===""?"":` ${a.name}`} --help`).join(`
`)})}let c=this.isGlobalCommand?n:[...this.options,...n||[]];if(!this.isGlobalCommand&&!this.isDefaultCommand)c=c.filter((r)=>r.name!=="version");if(c.length>0){let r=z(c.map((a)=>a.rawName));i.push({title:"Options",body:c.map((a)=>{return`  ${K(a.rawName,r.length)}  ${a.description} ${a.config.default===void 0?"":`(default: ${a.config.default})`}`}).join(`
`)})}if(this.examples.length>0)i.push({title:"Examples",body:this.examples.map((r)=>{if(typeof r==="function")return r(t);return r}).join(`
`)});if(s)i=s(i)||i;console.log(i.map((r)=>{return r.title?`${r.title}:
${r.body}`:r.body}).join(`

`))}outputVersion(){let{name:t}=this.cli,{versionNumber:e}=this.cli.globalCommand;if(e)console.log(`${t}/${e} ${Ie}`)}checkRequiredArgs(){let t=this.args.filter((e)=>e.required).length;if(this.cli.args.length<t)throw new $(`missing required args for command \`${this.rawName}\``)}checkUnknownOptions(){let{options:t,globalCommand:e}=this.cli;if(!this.config.allowUnknownOptions){for(let o of Object.keys(t))if(o!=="--"&&!this.hasOption(o)&&!e.hasOption(o))throw new $(`Unknown option \`${o.length>1?`--${o}`:`-${o}`}\``)}}checkOptionValue(){let{options:t,globalCommand:e}=this.cli,o=[...e.options,...this.options];for(let n of o){let s=t[n.name.split(".")[0]];if(n.required){let i=o.some((l)=>l.negated&&l.names.includes(n.name));if(s===!0||s===!1&&!i)throw new $(`option \`${n.rawName}\` value is missing`)}}}}class L extends R{constructor(t){super("@@global@@","",{},t)}}var C=Object.assign;class Z extends ve{constructor(t=""){super();this.name=t,this.commands=[],this.rawArgs=[],this.args=[],this.options={},this.globalCommand=new L(this),this.globalCommand.usage("<command> [options]")}usage(t){return this.globalCommand.usage(t),this}command(t,e,o){let n=new R(t,e||"",o,this);return n.globalCommand=this.globalCommand,this.commands.push(n),n}option(t,e,o){return this.globalCommand.option(t,e,o),this}help(t){return this.globalCommand.option("-h, --help","Display this message"),this.globalCommand.helpCallback=t,this.showHelpOnExit=!0,this}version(t,e="-v, --version"){return this.globalCommand.version(t,e),this.showVersionOnExit=!0,this}example(t){return this.globalCommand.example(t),this}outputHelp(){if(this.matchedCommand)this.matchedCommand.outputHelp();else this.globalCommand.outputHelp()}outputVersion(){this.globalCommand.outputVersion()}setParsedInfo({args:t,options:e},o,n){if(this.args=t,this.options=e,o)this.matchedCommand=o;if(n)this.matchedCommandName=n;return this}unsetMatchedCommand(){this.matchedCommand=void 0,this.matchedCommandName=void 0}parse(t=Ae,{run:e=!0}={}){if(this.rawArgs=t,!this.name)this.name=t[1]?Ee(t[1]):"cli";let o=!0;for(let s of this.commands){let i=this.mri(t.slice(2),s),l=i.args[0];if(s.isMatched(l)){o=!1;let c=C(C({},i),{args:i.args.slice(1)});this.setParsedInfo(c,s,l),this.emit(`command:${l}`,s)}}if(o){for(let s of this.commands)if(s.name===""){o=!1;let i=this.mri(t.slice(2),s);this.setParsedInfo(i,s),this.emit("command:!",s)}}if(o){let s=this.mri(t.slice(2));this.setParsedInfo(s)}if(this.options.help&&this.showHelpOnExit)this.outputHelp(),e=!1,this.unsetMatchedCommand();if(this.options.version&&this.showVersionOnExit&&this.matchedCommandName==null)this.outputVersion(),e=!1,this.unsetMatchedCommand();let n={args:this.args,options:this.options};if(e)this.runMatchedCommand();if(!this.matchedCommand&&this.args[0])this.emit("command:*");return n}mri(t,e){let o=[...this.globalCommand.options,...e?e.options:[]],n=Oe(o),s=[],i=t.indexOf("--");if(i>-1)s=t.slice(i+1),t=t.slice(0,i);let l=$e(t,n);l=Object.keys(l).reduce((d,g)=>{return C(C({},d),{[Q(g)]:l[g]})},{_:[]});let c=l._,r={"--":s},a=e&&e.config.ignoreOptionDefaultValue?e.config.ignoreOptionDefaultValue:this.globalCommand.config.ignoreOptionDefaultValue,h=Object.create(null);for(let d of o){if(!a&&d.config.default!==void 0)for(let g of d.names)r[g]=d.config.default;if(Array.isArray(d.config.type)){if(h[d.name]===void 0)h[d.name]=Object.create(null),h[d.name].shouldTransform=!0,h[d.name].transformFunction=d.config.type[0]}}for(let d of Object.keys(l))if(d!=="_"){let g=d.split(".");Be(r,g,l[d]),Pe(r,h)}return{args:c,options:r}}runMatchedCommand(){let{args:t,options:e,matchedCommand:o}=this;if(!o||!o.commandAction)return;o.checkUnknownOptions(),o.checkOptionValue(),o.checkRequiredArgs();let n=[];return o.args.forEach((s,i)=>{if(s.variadic)n.push(t.slice(i));else n.push(t[i])}),n.push(e),o.commandAction.apply(this,n)}}var ee=(t="")=>new Z(t);q();F();var v=ee("workspace");v.command("setup","\u958B\u767A\u74B0\u5883\u306E\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3092\u5B9F\u884C\u3057\u307E\u3059").option("--install","\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306E\u307F\u5B9F\u884C").option("--docker","Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306E\u307F\u5B9F\u884C").option("--no-parallel","\u4E26\u5217\u5B9F\u884C\u3092\u7121\u52B9\u5316").action(async(t)=>{let e={install:t.install!==void 0,docker:t.docker!==void 0,parallel:!t["no-parallel"]};await V(e)});v.command("check","\u5FC5\u8981\u306A\u30B3\u30DE\u30F3\u30C9\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u78BA\u8A8D\u3068\u5BFE\u8A71\u7684\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3092\u5B9F\u884C\u3057\u307E\u3059").action(async()=>{await P()});v.command("*","\u958B\u767A\u74B0\u5883\u306E\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3092\u5B9F\u884C\u3057\u307E\u3059").action(async()=>{let{runWorkspace:t}=await Promise.resolve().then(() => (F(),ge));await t()});v.help();v.version("1.0.1");v.parse();
