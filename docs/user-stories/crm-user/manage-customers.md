---
title: 顧客管理
description: CRMユーザーによる顧客情報の管理
---

## ストーリー

**As a** CRM User（CRMユーザー）
**I want to** 顧客情報を管理したい
**So that** 顧客との関係を効果的に管理できる

## ペルソナ

| 属性 | 値 |
| ---- | -- |
| 名前 | CRM User |
| 役割 | crm-user |
| 技術レベル | 中級者 |
| 主な目的 | 顧客情報の一元管理 |

## 前提条件

- CRMユーザーとしてログイン済み
- CRM機能へのアクセス権限がある

## 受け入れ条件（Acceptance Criteria）

### AC1: 顧客一覧の表示

**Given** CRMユーザーがログインしている
**When** 顧客管理ページにアクセスする
**Then** すべての顧客が一覧表示される

### AC2: 顧客の検索とフィルタリング

**Given** 顧客一覧ページにいる
**When** 検索キーワードを入力する、またはフィルターを適用する
**Then** 条件に一致する顧客のみが表示される

### AC3: 新規顧客の作成

**Given** 顧客一覧ページにいる
**When** 「新規作成」ボタンをクリックし、顧客情報を入力して保存する
**Then** 新しい顧客が作成される

### AC4: 顧客情報の編集

**Given** 顧客詳細ページにいる
**When** 顧客情報を編集して保存する
**Then** 顧客情報が更新される

### AC5: 顧客の削除

**Given** 顧客詳細ページにいる
**When** 「削除」ボタンをクリックし、確認する
**Then** 顧客が削除される

### AC6: 顧客履歴の表示

**Given** 顧客詳細ページにいる
**When** 「履歴」タブをクリックする
**Then** 顧客とのやり取り履歴が表示される

## シナリオ

### 正常系シナリオ

1. CRMユーザーは管理画面にログインする
2. サイドバーから「顧客」をクリックする
3. 顧客一覧が表示される
4. 「新規作成」ボタンをクリックする
5. 会社名、担当者名、メール、電話番号を入力する
6. 「保存」ボタンをクリックする
7. 顧客が作成され、詳細ページが表示される

### 異常系シナリオ

1. 必須フィールドが空の場合、バリデーションエラー
2. メールアドレスが重複している場合、警告を表示

## UI/UX要件

### 画面構成

```text
┌─────────────────────────────────────────────┐
│ Header (Navigation)                          │
├──────────┬──────────────────────────────────┤
│          │ 顧客管理                          │
│ Sidebar  │ [検索] [フィルター] [新規作成]   │
│          ├──────────────────────────────────┤
│          │ ┌────────────────────────────┐   │
│          │ │ 会社名 │ 担当者 │ 状態 │操作│   │
│          │ ├────────────────────────────┤   │
│          │ │ A社    │ 田中   │ 有効 │詳細│   │
│          │ │ B社    │ 鈴木   │ 有効 │詳細│   │
│          │ └────────────────────────────┘   │
└──────────┴───────────────────────────────────┘
```

### 必要な要素

| 要素 | 種類 | 説明 |
| ---- | ---- | ---- |
| 検索バー | input | キーワード検索 |
| フィルター | dropdown | ステータス等でフィルタリング |
| 顧客テーブル | table | 顧客一覧を表示 |
| 詳細ボタン | button | 顧客詳細ページへ遷移 |

## テスト

### E2Eテスト

- ファイル: `apps/admin/e2e/large/crm-user/manage-customers.large.spec.ts`
- 対応するAC: AC1, AC2, AC3, AC4, AC5, AC6

### テストシナリオ

| シナリオ | AC | 自動化 |
| -------- | -- | ------ |
| 一覧表示 | AC1 | Yes |
| 検索・フィルター | AC2 | Yes |
| 新規作成 | AC3 | Yes |
| 編集 | AC4 | Yes |
| 削除 | AC5 | Yes |
| 履歴表示 | AC6 | Yes |

## 関連

- シーケンス図: `docs/sequence/api/crm/customer-*.md`
- API仕様: `docs/specs/api/crm.md`
- 画面: `apps/admin/app/routes/crm/customers/`
