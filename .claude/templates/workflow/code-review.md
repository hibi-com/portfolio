# コードレビューテンプレート

## IMPORTANT: このテンプレートに従って一貫した形式でコードレビューを行うこと

## レビュー手順

### Step 1: 変更概要の把握

```bash
# 変更されたファイル一覧
git diff --name-only {base}..{head}

# 変更統計
git diff --stat {base}..{head}

# コミット履歴
git log --oneline {base}..{head}
```

#### 変更概要

| 項目 | 値 |
| ---- | -- |
| 変更ファイル数 | {count} |
| 追加行数 | {additions} |
| 削除行数 | {deletions} |
| コミット数 | {commits} |

### Step 2: レビューチェックリスト

#### 機能要件

- [ ] 仕様書（シーケンス図、API仕様）と実装が一致している
- [ ] 受け入れ条件を満たしている
- [ ] エッジケースが考慮されている

#### コード品質

- [ ] 単一責任の原則に従っている
- [ ] 関数/メソッドが適切なサイズである（50行以下推奨）
- [ ] 命名が明確で意図が伝わる
- [ ] 重複コードがない（DRY原則）
- [ ] 不要なコメントがない（コードで意図が伝わる）

#### エラーハンドリング

- [ ] エラーケースが適切に処理されている
- [ ] エラーメッセージがユーザーフレンドリー
- [ ] 例外が握りつぶされていない

#### セキュリティ

- [ ] SQLインジェクション対策（パラメータバインディング）
- [ ] XSS対策（エスケープ処理）
- [ ] CSRF対策
- [ ] 認証・認可が適切
- [ ] 機密情報がハードコードされていない

#### パフォーマンス

- [ ] N+1問題がない
- [ ] 不要なクエリがない
- [ ] 適切なインデックスが使用されている
- [ ] メモリリークの懸念がない

#### テスト

- [ ] ユニットテストが追加されている
- [ ] テストが適切なケースをカバーしている
- [ ] テストが読みやすく保守しやすい

#### 型安全性

- [ ] any型が使用されていない
- [ ] 適切な型定義がある
- [ ] null/undefined が適切に処理されている

### Step 3: 具体的なフィードバック

#### フィードバックの種類

| プレフィックス | 意味 | 対応 |
| -------------- | ---- | ---- |
| `[MUST]` | 必須修正 | マージ前に修正必要 |
| `[SHOULD]` | 推奨修正 | 可能であれば修正 |
| `[COULD]` | 提案 | 任意 |
| `[QUESTION]` | 質問 | 回答必要 |
| `[PRAISE]` | 良い点 | - |

#### フィードバック形式

```markdown
### {ファイルパス}:{行番号}

**[{種類}]** {タイトル}

{説明}

**現在のコード:**
\`\`\`typescript
{現在のコード}
\`\`\`

**提案:**
\`\`\`typescript
{提案コード}
\`\`\`

**理由:** {なぜこの変更が必要か}
```

### Step 4: レビュー結果のまとめ

```markdown
## コードレビュー結果

### 総合評価

| 観点 | 評価 | コメント |
| ---- | ---- | -------- |
| 機能要件 | {✅/⚠️/❌} | {コメント} |
| コード品質 | {✅/⚠️/❌} | {コメント} |
| エラーハンドリング | {✅/⚠️/❌} | {コメント} |
| セキュリティ | {✅/⚠️/❌} | {コメント} |
| パフォーマンス | {✅/⚠️/❌} | {コメント} |
| テスト | {✅/⚠️/❌} | {コメント} |
| 型安全性 | {✅/⚠️/❌} | {コメント} |

### 指摘事項サマリー

| 種類 | 件数 |
| ---- | ---- |
| [MUST] | {count} |
| [SHOULD] | {count} |
| [COULD] | {count} |
| [QUESTION] | {count} |

### 良い点

- {良い点1}
- {良い点2}

### 修正必須事項

1. {MUST事項1}
2. {MUST事項2}

### 推奨事項

1. {SHOULD事項1}
2. {SHOULD事項2}

### 承認ステータス

- [ ] **Approve**: 指摘事項なし、マージ可能
- [ ] **Approve with comments**: 軽微な指摘あり、修正後マージ可能
- [ ] **Request changes**: 必須修正あり、再レビュー必要
```

## レビュー観点詳細

### アーキテクチャ観点

| チェック | 説明 |
| -------- | ---- |
| レイヤー分離 | 依存関係が正しい方向か |
| 責務の配置 | 適切なレイヤーに配置されているか |
| インターフェース | 抽象に依存しているか |

### このプロジェクト固有の観点

| チェック | 説明 |
| -------- | ---- |
| FSD構造 | features/entities/shared の配置が適切か |
| DDD構造 | domain/application/infrastructure の分離が適切か |
| シーケンス図 | 実装がシーケンス図と一致しているか |
