# コードレビュー結果ログ

このテンプレートは、`/review` スキル実行後のレビュー結果を記録するために使用します。

## ファイル名

```text
logs/review/YYYY-MM-DD-{description}.md
```

例:

- `logs/review/2026-02-19-api-posts-endpoint.md`
- `logs/review/2026-02-19-admin-dashboard-refactor.md`
- `logs/review/2026-02-19-pr-123.md`

## テンプレート

```markdown
# コードレビュー結果

## レビュー結果サマリー

- **対象**: {ファイルパスまたはPR番号}
- **レビュー日時**: {YYYY-MM-DD HH:mm}
- **レビュアー**: Claude Code
- **総合評価**: ✅ 承認 / ⚠️ 要修正 / ❌ 却下

## 🔴 クリティカル（即修正必須）

セキュリティ脆弱性、データ損失リスク、本番環境での障害リスクがある項目。

- [ ] {項目1: 具体的な問題と影響範囲}
- [ ] {項目2: 具体的な問題と影響範囲}

## 🟠 重要（修正推奨）

品質、保守性、パフォーマンスに影響する項目。

- [ ] {項目1: 具体的な問題と推奨される対応}
- [ ] {項目2: 具体的な問題と推奨される対応}

## 🟡 軽微（任意）

コードスタイル、可読性向上、将来的な改善提案。

- [ ] {項目1: 改善提案}
- [ ] {項目2: 改善提案}

## ✅ 良い点

コードの優れた点、ベストプラクティスに従っている点。

- {項目1: 具体的に良い点を記載}
- {項目2: 具体的に良い点を記載}

## 📝 コメント

### 品質レビュー

- **可読性**: {コメント}
- **保守性**: {コメント}
- **テスタビリティ**: {コメント}

### セキュリティレビュー

- **OWASP対応**: {コメント}
- **機密情報管理**: {コメント}

### パフォーマンスレビュー

- **データベース**: {コメント}
- **フロントエンド**: {コメント}
- **API**: {コメント}

### アーキテクチャレビュー

- **レイヤー分離**: {コメント}
- **依存関係**: {コメント}

### テストレビュー

- **テスト戦略**: {コメント}
- **テストカバレッジ**: {コメント}

### ドキュメントレビュー

- **シーケンス図**: {コメント}
- **API仕様**: {コメント}

## 自動チェック結果

### Lint

```bash
bun run lint
```

```
{lint結果を貼り付け}
```

### Type Check

```bash
bun run typecheck
```

```
{型チェック結果を貼り付け}
```

### Test

```bash
bun run test
```

```
{テスト結果を貼り付け}
```

### Coverage

```bash
bun run coverage
```

```
{カバレッジ結果を貼り付け}
```

## 参考ドキュメント

- [コードレビューガイド](../../docs/development/code-review.md)
- [コーディング規約](../../docs/development/coding-standards.md)
- [セキュリティガイドライン](../../docs/security/guidelines.md)
- [テスト戦略](../../docs/testing/testing-strategy.md)

## 次のアクション

- [ ] クリティカル項目の修正
- [ ] 重要項目の修正
- [ ] テストの追加/更新
- [ ] ドキュメントの更新
- [ ] 再レビュー依頼
```

## 使用例

### 例1: APIエンドポイントのレビュー

```markdown
# コードレビュー結果

## レビュー結果サマリー

- **対象**: `apps/api/src/interface/rest/posts.ts`
- **レビュー日時**: 2026-02-19 14:30
- **レビュアー**: Claude Code
- **総合評価**: ⚠️ 要修正

## 🔴 クリティカル（即修正必須）

- [ ] SQLインジェクション対策が不足: `prisma.post.findMany({ where: { title: userInput } })` でバリデーションなし（apps/api/src/interface/rest/posts.ts:45）

## 🟠 重要（修正推奨）

- [ ] N+1クエリ問題: `post.author` へのアクセスで追加クエリが発行される。`include: { author: true }` の使用を推奨（apps/api/src/interface/rest/posts.ts:60）
- [ ] エラーハンドリング不足: `catch` ブロックでエラーログが出力されていない（apps/api/src/interface/rest/posts.ts:80）

## 🟡 軽微（任意）

- [ ] 変数名 `tmp` は意図が不明確。`filteredPosts` など具体的な名前を推奨（apps/api/src/interface/rest/posts.ts:55）

## ✅ 良い点

- DIコンテナ経由でRepositoryを注入している
- エラーレスポンスが `AppError` で統一されている
- 型定義が明示的でanyを使用していない

## 📝 コメント

### セキュリティレビュー

- **OWASP対応**: Injectionリスクあり。バリデーション層でのチェックが必要。

### パフォーマンスレビュー

- **データベース**: N+1問題を解消すれば良好。

### テストレビュー

- **テストカバレッジ**: Medium Test未実装。`tests/medium/posts/getPosts.medium.test.ts` の追加が必要。
```

### 例2: PR全体のレビュー

```markdown
# コードレビュー結果

## レビュー結果サマリー

- **対象**: PR #123 - ユーザー認証機能追加
- **レビュー日時**: 2026-02-19 16:00
- **レビュアー**: Claude Code
- **総合評価**: ✅ 承認

## 🔴 クリティカル（即修正必須）

なし

## 🟠 重要（修正推奨）

なし

## 🟡 軽微（任意）

- [ ] パスワードハッシュの強度をさらに上げる検討（現在bcrypt rounds=10、12以上を推奨）

## ✅ 良い点

- Better Authを使用した堅牢な認証フロー
- CSRF対策が適切に実装されている
- セッション管理がRedisで実装されている
- Medium Testが完備されている
- シーケンス図が更新されている

## 📝 コメント

### セキュリティレビュー

- **認証フロー**: Better Authのベストプラクティスに従っている
- **機密情報**: 環境変数で適切に管理されている

### テストレビュー

- **テストカバレッジ**: Branches 100%達成
- **テスト戦略**: Medium Test中心で適切
```

## 注意事項

1. **総合評価の基準**:
   - **✅ 承認**: クリティカルなし、重要な問題なし
   - **⚠️ 要修正**: 重要な問題あり（修正後の再レビュー推奨）
   - **❌ 却下**: クリティカルな問題あり（即修正必須）

2. **問題の分類**:
   - **🔴 クリティカル**: セキュリティ、データ損失、障害リスク
   - **🟠 重要**: 品質、保守性、パフォーマンス
   - **🟡 軽微**: スタイル、可読性、将来的改善

3. **具体性**:
   - ファイルパスと行番号を明記
   - 問題の影響範囲を説明
   - 推奨される対応方法を提示

4. **ポジティブフィードバック**:
   - 良い点も必ず記載
   - ベストプラクティスに従っている点を評価
